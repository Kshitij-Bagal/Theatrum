import{r as d,u as S,c as D,b as V,j as e,g as k,h as E,i as w,k as F,m as _}from"./index-DU0KpIvo.js";const L=h=>{const[m,l]=d.useState(null),[a,p]=d.useState(!0),[u,r]=d.useState(null);return d.useEffect(()=>{(async()=>{try{const s=await fetch(`https://theatrum-server.onrender.com/api/channels/user/${h}`);if(!s.ok){if(s.status===404){console.log("user does not have channel kindly create one"),l(null);return}throw new Error(`Error ${s.status}: ${s.statusText}`)}const i=await s.json();l(i)}catch(s){console.error("Fetch Error:",s),r(s.message)}finally{p(!1)}})()},[h]),{userChannel:m,loading:a,error:u,updateVideo:async(c,s)=>{try{return(await axios.put(`https://theatrum-server.onrender.com/api/videos/${c}`,s)).data}catch(i){r(i.message)}}}},U=["Sci-Fi","Adventure","Sports","Healthcare","Anime","Cartoon","Politics","News","Entertainment","Knowledge","Gaming","Movies","TV Shows","Vlogs","Podcasts","Tech","Music","Education","Fashion","Lifestyle","Fitness","Cooking","DIY","Business","Finance","Science","Nature","History","Religion","Culture","Travel","Food","Documentary","Comedy","Drama","Action","Fantasy","Calm","Horror","Thriller","Romance","Mystery","Biography","Crime","Western","Musical","War","Supernatural","Family","Animation","Superhero","Spy"];function A(){var b;const{userId:h}=S(),m=D(),l=V(),{userChannel:a,loading:p,error:u}=L(h),[r,g]=d.useState({name:"",description:"",logo:"",banner:""}),[c,s]=d.useState([]);d.useEffect(()=>{a&&(g({name:a.name,description:a.description,logo:a.logo,banner:a.banner}),s(a.videos||[]))},[a]);const i=n=>{g({...r,[n.target.name]:n.target.value})},C=n=>{n.preventDefault(),l(a?w({id:a._id,updatedData:r}):F({...r,owner:h}))},f=()=>{l(_(a._id)),m("/")},v=n=>{l(E(n)),s(c.filter(o=>o._id!==n))},x=(n,o,t)=>{s(N=>N.map(j=>j._id===n?{...j,[o]:t}:j))},y=n=>{const o=c.find(t=>t._id===n);l(k({id:n,updatedData:o}))};return p?e.jsx("h2",{children:"Loading..."}):u?e.jsxs("h2",{children:["Error: ",u]}):e.jsx("div",{className:"channel",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"channel-banner",children:e.jsx("img",{src:a.banner,alt:"Channel Banner",className:"banner-image"})}),e.jsxs("div",{className:"channel-header",children:[e.jsx("img",{src:a.logo,alt:"Channel Logo",className:"channel-logo"}),e.jsxs("div",{className:"channel-info",children:[e.jsx("h1",{children:a.name}),e.jsxs("p",{children:[(b=a.subscribers)==null?void 0:b.toLocaleString()," Subscribers"]}),e.jsxs("p",{children:[c.length," Videos"]})]})]}),e.jsxs("div",{className:"channel-description",children:[e.jsx("h2",{children:"About this channel"}),e.jsx("p",{children:a.description})]}),e.jsxs("div",{className:"channel-videos",children:[e.jsx("h2",{children:"Videos"}),e.jsx("div",{className:"video-list",children:c.map(n=>{var o;return e.jsxs("div",{className:"video-card",children:[e.jsx("img",{src:n.thumbnailUrl||"fallback-thumbnail.jpg",alt:n.title||"Untitled"}),e.jsx("input",{type:"text",value:n.title,onChange:t=>x(n._id,"title",t.target.value)}),e.jsx("input",{type:"text",value:n.tags,onChange:t=>x(n._id,"tags",t.target.value)}),e.jsx("select",{value:n.type,onChange:t=>x(n._id,"type",t.target.value),children:U.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("p",{children:[(o=n.views)==null?void 0:o.toLocaleString()," views"]}),e.jsxs("p",{children:[n.likes," Likes | ",n.dislikes," Dislikes"]}),e.jsx("button",{onClick:()=>y(n._id),className:"update-video-btn",children:"Update Video"}),e.jsx("button",{onClick:()=>v(n._id),className:"delete-video-btn",children:"Delete Video"})]},n._id)})})]}),e.jsxs("div",{className:"channel-management",children:[e.jsx("button",{onClick:C,className:"edit-btn",children:"Edit Channel"}),e.jsx("button",{onClick:f,className:"delete-btn",children:"Delete Channel"})]})]}):e.jsxs("div",{className:"create-channel",children:[e.jsx("h2",{children:"Create Your Channel"}),e.jsxs("form",{onSubmit:C,children:[e.jsx("input",{type:"text",name:"name",placeholder:"Channel Name",value:r.name,onChange:i,required:!0}),e.jsx("input",{type:"text",name:"description",placeholder:"Description",value:r.description,onChange:i,required:!0}),e.jsx("input",{type:"text",name:"logo",placeholder:"Logo URL",value:r.logo,onChange:i,required:!0}),e.jsx("input",{type:"text",name:"banner",placeholder:"Banner URL",value:r.banner,onChange:i,required:!0}),e.jsx("button",{type:"submit",children:"Create Channel"})]})]})})}export{A as default};
