import{j as e,L as u,r as j}from"./index-DU0KpIvo.js";import{F as N,a as V}from"./index-CwRFEMWb.js";/* empty css                  */function T({video:s,channel:t}){if(!s||!s._id||!s.channelId)return e.jsx("div",{className:"error",children:"Invalid video data"});const d=typeof s.channelId=="object"?s.channelId._id:s.channelId,p=(t==null?void 0:t.logo)||s.channelId.logo,y=(t==null?void 0:t.name)||s.channelId.name;return e.jsx("div",{className:"video-card",children:e.jsxs(u,{to:`/${d}/${s._id}`,className:"video-link",children:[e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"thumbnail"}),e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"channel-avatar",children:e.jsx("img",{src:p||"default-logo.png",alt:"Channel Avatar"})}),e.jsxs("div",{className:"video-info",children:[e.jsx("h3",{className:"video-title",children:s.title}),e.jsx("span",{className:"channel-name",children:y||"Unkown Channel"}),e.jsxs("div",{className:"video-stats",children:[e.jsxs("span",{children:[e.jsx(N,{})," ",s.views||0," views"]}),e.jsxs("span",{children:[e.jsx(V,{})," ",s.likes||0," likes"]})]})]})]})]})})}function $({videos:s}){return e.jsx("div",{className:"video-list",children:s.length>0?s.map(t=>e.jsx(T,{video:t},t._id)):e.jsx("p",{children:"No videos found. Try uploading some!"})})}const E=()=>{const[s,t]=j.useState([]),[d,p]=j.useState(!1),[y,i]=j.useState(null),r="https://theatrum-server.onrender.com",c=async()=>{p(!0);try{const n=await(await fetch(`${r}/api/videos`)).json();t(n)}catch(a){i(a.message)}finally{p(!1)}},h=async a=>{try{const o=await(await fetch(`${r}/api/videos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();t(l=>[...l,o])}catch(n){i(n.message)}},x=async(a,n)=>{try{const l=await(await fetch(`${r}/api/videos/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();t(m=>m.map(f=>f._id===a?l:f))}catch(o){i(o.message)}},g=async a=>{try{await fetch(`${r}/api/videos/${a}`,{method:"DELETE"}),t(n=>n.filter(o=>o._id!==a))}catch(n){i(n.message)}},v=async a=>{try{const o=await(await fetch(`${r}/api/videos/${a}/like`,{method:"POST"})).json();t(l=>l.map(m=>m._id===a?o:m))}catch(n){i(n.message)}},w=async(a,n)=>{try{const l=await(await fetch(`${r}/api/videos/${a}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();t(m=>m.map(f=>f._id===a?l:f))}catch(o){i(o.message)}};return j.useEffect(()=>{c()},[]),{videos:s,loading:d,error:y,fetchVideos:c,createVideo:h,updateVideo:x,deleteVideo:g,likeVideo:v,addComment:w}};function _(){const{videos:s,loading:t,error:d,fetchVideos:p}=E(),[y,i]=j.useState([]);j.useEffect(()=>{p(),r()},[]);const r=async()=>{try{const h=await(await fetch("https://theatrum-server.onrender.com/api/videos/get/types")).json();Array.isArray(h)?i(h):i([])}catch(c){console.error("Error fetching video types:",c),i([])}};return e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"video_types",children:y.map((c,h)=>e.jsx(u,{to:`/browse/${encodeURIComponent(c)}`,className:"video-type",children:c},h))}),t&&e.jsx("p",{children:"Loading videos..."}),d&&e.jsx("p",{children:d}),!t&&!d&&e.jsx($,{videos:s})]})}export{_ as default};
