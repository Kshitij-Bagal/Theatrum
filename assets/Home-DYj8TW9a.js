import{j as e,L as v,F as N,r as m}from"./index-qpR2RHHa.js";/* empty css                  */function $({video:s,channel:t}){var i,d;if(!s||!s._id||!s.channelId)return e.jsx("div",{className:"error",children:"Invalid video data"});const p=typeof s.channelId=="object"?s.channelId._id:s.channelId,f=(t==null?void 0:t.logo)||((i=s.channelId)==null?void 0:i.logo)||"default-logo.png",u=(t==null?void 0:t.name)||((d=s.channelId)==null?void 0:d.name)||"Unknown Channel",r=y=>{const g=new Date(y),l=Math.floor((new Date-g)/1e3),w={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};for(const[o,n]of Object.entries(w)){const a=Math.floor(l/n);if(a>=1)return`${a} ${o}${a>1?"s":""} ago`}return"Just now"};return e.jsx("div",{className:"video-card",children:e.jsxs(v,{to:`/${p}/${s._id}`,className:"video-link",children:[e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"thumbnail"}),e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"channel-avatar",children:e.jsx("img",{src:f,alt:"Channel Avatar"})}),e.jsxs("div",{className:"video-info",children:[e.jsx("h3",{className:"video-title",children:s.title}),e.jsx("span",{className:"channel-name",children:u}),e.jsxs("div",{className:"video-stats",children:[e.jsxs("span",{children:[s.views||0," ",e.jsx(N,{})]}),e.jsx("span",{children:r(s.uploadDate)})]})]})]})]})})}function V({videos:s}){return e.jsx("div",{className:"video-list",children:s.length>0?s.map(t=>e.jsx($,{video:t},t._id)):e.jsx("p",{children:"No videos found. Try uploading some!"})})}const T=()=>{const[s,t]=m.useState([]),[p,f]=m.useState(!1),[u,r]=m.useState(null),i="https://youtubecloneserver-ro5i.onrender.com",d=async()=>{f(!0);try{const n=await(await fetch(`${i}/api/videos`)).json();t(n)}catch(o){r(o.message)}finally{f(!1)}},y=async o=>{try{const a=await(await fetch(`${i}/api/videos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();t(h=>[...h,a])}catch(n){r(n.message)}},g=async(o,n)=>{try{const h=await(await fetch(`${i}/api/videos/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();t(j=>j.map(x=>x._id===o?h:x))}catch(a){r(a.message)}},c=async o=>{try{await fetch(`${i}/api/videos/${o}`,{method:"DELETE"}),t(n=>n.filter(a=>a._id!==o))}catch(n){r(n.message)}},l=async o=>{try{const a=await(await fetch(`${i}/api/videos/${o}/like`,{method:"POST"})).json();t(h=>h.map(j=>j._id===o?a:j))}catch(n){r(n.message)}},w=async(o,n)=>{try{const h=await(await fetch(`${i}/api/videos/${o}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();t(j=>j.map(x=>x._id===o?h:x))}catch(a){r(a.message)}};return m.useEffect(()=>{d()},[]),{videos:s,loading:p,error:u,fetchVideos:d,createVideo:y,updateVideo:g,deleteVideo:c,likeVideo:l,addComment:w}};function E(){const{videos:s,loading:t,error:p,fetchVideos:f}=T(),[u,r]=m.useState([]),[i,d]=m.useState(!0),y="https://youtubecloneserver-ro5i.onrender.com";m.useEffect(()=>{f(),g()},[y]);const g=async()=>{try{d(!0);const c=await fetch(`${y}/api/videos/get/types`);if(!c.ok)throw new Error("Failed to fetch video types");const l=await c.json();r(Array.isArray(l)?l:[])}catch(c){console.error("Error fetching video types:",c),r([])}finally{d(!1)}};return e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"video_types",children:i?e.jsx("p",{children:"Loading categories..."}):u.length>0?u.map((c,l)=>e.jsx(v,{to:`/browse/${encodeURIComponent(c)}`,className:"video-type",children:c},l)):e.jsx("p",{children:"No categories found."})}),t&&e.jsx("p",{children:"Loading videos..."}),p&&e.jsx("p",{children:p}),!t&&!p&&e.jsx(V,{videos:s})]})}export{E as default};
