import{j as e,L as v,F as N,r as u}from"./index-CQaYZTkb.js";/* empty css                  */function $({video:s,channel:o}){if(!s||!s._id||!s.channelId)return e.jsx("div",{className:"error",children:"Invalid video data"});const l=typeof s.channelId=="object"?s.channelId._id:s.channelId,h=(o==null?void 0:o.logo)||s.channelId.logo,y=(o==null?void 0:o.name)||s.channelId.name,a=c=>{const m=new Date(c),d=Math.floor((new Date-m)/1e3),g={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};for(const[x,w]of Object.entries(g)){const t=Math.floor(d/w);if(t>=1)return`${t} ${x}${t>1?"s":""} ago`}return"Just now"};return e.jsx("div",{className:"video-card",children:e.jsxs(v,{to:`/${l}/${s._id}`,className:"video-link",children:[e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"thumbnail"}),e.jsxs("div",{className:"card-content",children:[e.jsx("div",{className:"channel-avatar",children:e.jsx("img",{src:h||"default-logo.png",alt:"Channel Avatar"})}),e.jsxs("div",{className:"video-info",children:[e.jsx("h3",{className:"video-title",children:s.title}),e.jsx("span",{className:"channel-name",children:y||"Unknown Channel"}),e.jsxs("div",{className:"video-stats",children:[e.jsxs("span",{children:[s.views||0," ",e.jsx(N,{})]}),e.jsx("span",{children:a(s.uploadDate)})," "]})]})]})]})})}function V({videos:s}){return e.jsx("div",{className:"video-list",children:s.length>0?s.map(o=>e.jsx($,{video:o},o._id)):e.jsx("p",{children:"No videos found. Try uploading some!"})})}const T=()=>{const[s,o]=u.useState([]),[l,h]=u.useState(!1),[y,a]=u.useState(null),c="https://youtubecloneserver-ro5i.onrender.com",m=async()=>{h(!0);try{const n=await(await fetch(`${c}/api/videos`)).json();o(n)}catch(t){a(t.message)}finally{h(!1)}},i=async t=>{try{const r=await(await fetch(`${c}/api/videos`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();o(p=>[...p,r])}catch(n){a(n.message)}},d=async(t,n)=>{try{const p=await(await fetch(`${c}/api/videos/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();o(f=>f.map(j=>j._id===t?p:j))}catch(r){a(r.message)}},g=async t=>{try{await fetch(`${c}/api/videos/${t}`,{method:"DELETE"}),o(n=>n.filter(r=>r._id!==t))}catch(n){a(n.message)}},x=async t=>{try{const r=await(await fetch(`${c}/api/videos/${t}/like`,{method:"POST"})).json();o(p=>p.map(f=>f._id===t?r:f))}catch(n){a(n.message)}},w=async(t,n)=>{try{const p=await(await fetch(`${c}/api/videos/${t}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();o(f=>f.map(j=>j._id===t?p:j))}catch(r){a(r.message)}};return u.useEffect(()=>{m()},[]),{videos:s,loading:l,error:y,fetchVideos:m,createVideo:i,updateVideo:d,deleteVideo:g,likeVideo:x,addComment:w}};function E(){const{videos:s,loading:o,error:l,fetchVideos:h}=T(),[y,a]=u.useState([]),c="https://youtubecloneserver-ro5i.onrender.com";u.useEffect(()=>{h(),m()},[]);const m=async()=>{try{const d=await(await fetch(`${c}/api/videos/get/types`)).json();Array.isArray(d)?a(d):a([])}catch(i){console.error("Error fetching video types:",i),a([])}};return e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"video_types",children:y.map((i,d)=>e.jsx(v,{to:`/browse/${encodeURIComponent(i)}`,className:"video-type",children:i},d))}),o&&e.jsx("p",{children:"Loading videos..."}),l&&e.jsx("p",{children:l}),!o&&!l&&e.jsx(V,{videos:s})]})}export{E as default};
